{"version":3,"file":"js/413.4a867920.js","mappings":"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","sources":["webpack://chat-demo/./src/views/newGroupChat/BuildGroupChatPage.vue","webpack://chat-demo/src/views/newGroupChat/BuildGroupChatPage.vue","webpack://chat-demo/./src/views/newGroupChat/BuildGroupChatPage.vue?5ece","webpack://chat-demo/./src/views/newGroupChat/BuildGroupChatPage.vue?b3df"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"build-group-chat-page\"}},[_c('h3',[_c('van-icon',{attrs:{\"name\":\"arrow-left\",\"color\":\"rgb(107, 107, 107)\"},on:{\"click\":_vm.routerGoBack}}),_c('span',[_vm._v(\"发起群聊\")])],1),_c('div',{staticClass:\"concent-top\"},[_c('div',{staticClass:\"search\"},[_c('van-icon',{staticClass:\"search-icon\",attrs:{\"name\":\"search\"}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.inputValue),expression:\"inputValue\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"搜索\"},domProps:{\"value\":(_vm.inputValue)},on:{\"input\":function($event){if($event.target.composing)return;_vm.inputValue=$event.target.value}}})],1),_c('p',[_vm._v(\"选择一个群\")]),_c('p',[_vm._v(\"面对面建群\")]),_c('p',[_vm._v(\"企业联系人\")]),_c('div',{staticClass:\"friend-list\"},[_c('van-checkbox-group',{attrs:{\"direction\":\"horizontal\"},model:{value:(_vm.selectBuildGroupFriends),callback:function ($$v) {_vm.selectBuildGroupFriends=$$v},expression:\"selectBuildGroupFriends\"}},_vm._l((_vm.friendsBasicList),function(item){return _c('div',{key:item.phone,staticClass:\"friend-item\"},[_c('van-checkbox',{attrs:{\"name\":item.phone}}),_c('div',{staticClass:\"img\"},[_c('img',{attrs:{\"src\":_vm.showImg(item.avatarurl),\"alt\":\"head\"}})]),_c('div',{staticClass:\"desc\"},[_c('span',[_vm._v(_vm._s(item.nickname || item.phone))])])],1)}),0)],1)]),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showSureButton),expression:\"showSureButton\"}],staticClass:\"button\"},[_c('button',{on:{\"click\":_vm.isBuildGroup}},[_vm._v(\" 完成(\"+_vm._s(_vm.selectBuildGroupFriends.length)+\") \")])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"build-group-chat-page\">\r\n    <h3>\r\n      <van-icon\r\n        name=\"arrow-left\"\r\n        color=\"rgb(107, 107, 107)\"\r\n        @click=\"routerGoBack\"\r\n      />\r\n      <span>发起群聊</span>\r\n    </h3>\r\n    <div class=\"concent-top\">\r\n      <div class=\"search\">\r\n        <van-icon name=\"search\" class=\"search-icon\" />\r\n        <!-- @input=\"onSearch\" -->\r\n        <input\r\n          class=\"input\"\r\n          v-model=\"inputValue\"\r\n          type=\"text\"\r\n          placeholder=\"搜索\"\r\n        />\r\n      </div>\r\n      <p>选择一个群</p>\r\n      <p>面对面建群</p>\r\n      <p>企业联系人</p>\r\n      <div class=\"friend-list\">\r\n        <van-checkbox-group\r\n          v-model=\"selectBuildGroupFriends\"\r\n          direction=\"horizontal\"\r\n        >\r\n          <div\r\n            v-for=\"item in friendsBasicList\"\r\n            :key=\"item.phone\"\r\n            class=\"friend-item\"\r\n          >\r\n            <van-checkbox :name=\"item.phone\"></van-checkbox>\r\n            <div class=\"img\">\r\n              <img :src=\"showImg(item.avatarurl)\" alt=\"head\" />\r\n            </div>\r\n            <div class=\"desc\">\r\n              <span>{{ item.nickname || item.phone }}</span>\r\n            </div>\r\n          </div>\r\n        </van-checkbox-group>\r\n      </div>\r\n    </div>\r\n\r\n    <p class=\"button\" v-show=\"showSureButton\">\r\n      <button @click=\"isBuildGroup\">\r\n        完成({{ selectBuildGroupFriends.length }})\r\n      </button>\r\n    </p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport WebIM from \"../../utils/WebIM\";\r\nimport { mapState } from \"vuex\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      inputValue: \"\",\r\n      friendsBasicList: [],\r\n      selectBuildGroupFriends: [],\r\n      showSureButton: false,\r\n    };\r\n  },\r\n  created() {\r\n    this.getFriendsBasicList();\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      userId: (state) => state.user.userId,\r\n    }),\r\n  },\r\n  watch: {\r\n    selectBuildGroupFriends(newV) {\r\n      if (newV.length !== 0) {\r\n        this.showSureButton = true;\r\n      } else {\r\n        this.showSureButton = false;\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    routerGoBack() {\r\n      this.$router.go(-1);\r\n    },\r\n    getFriendsBasicList() {\r\n      WebIM.conn.getContacts(this.$store.state.user.userId).then((res) => {\r\n        res.data.map((item) => {\r\n          WebIM.conn.fetchUserInfoById(item).then((obj) => {\r\n            this.friendsBasicList.push(obj.data[item]);\r\n          });\r\n        });\r\n      });\r\n    },\r\n    showImg(img) {\r\n      if (img != undefined) {\r\n        return img;\r\n      } else {\r\n        return require(\"../../assets/image/addressImg/head.webp\");\r\n      }\r\n    },\r\n    isBuildGroup() {\r\n      // 超过两人才能建群\r\n      if (this.selectBuildGroupFriends.length > 1) {\r\n        let obj = [\r\n          this.$store.state.user.userId,\r\n          ...this.selectBuildGroupFriends,\r\n        ];\r\n        let option = {\r\n          data: {\r\n            // 群组名称\r\n            groupname: `群聊(${this.selectBuildGroupFriends.length + 1})`,\r\n            // 群组描述\r\n            desc: \"A description of a group\",\r\n            // 群成员的用户 ID 组成的数组\r\n            members: obj,\r\n            /*\r\n        是否为公开群：- true：是；- false：否。该群组为私有群。 */\r\n            public: true,\r\n            // 入群申请是否需群主或管理员审批 - true：需要；- false：不需要  私有群只能通过邀请方式进群\r\n            approval: false,\r\n            // 是否允许普通群成员邀请人入群：- true：允许；- false：不允许 只有群主和管理员才可以向群组添加用户。\r\n            allowinvites: true,\r\n            // 邀请加群时是否需要受邀用户确认： - true：受邀用户需同意才会加入群组；- false：受邀用户直接加入群组，无需确认。\r\n            inviteNeedConfirm: false,\r\n            // 群组最大成员数。\r\n            maxusers: 500,\r\n          },\r\n        };\r\n        // 创建群组\r\n        WebIM.conn\r\n          .createGroup(option)\r\n          .then((res) => {\r\n            let obj = {\r\n              id: res.data.groupid,\r\n              isNewCreate: true,\r\n            };\r\n            this.$store.commit(\"setNewCreateGroupId\", obj);\r\n            sessionStorage.setItem(\"groupInfoCacheSave\", res.data.groupid);\r\n            this.$toast.success(\"建立群聊成功\");\r\n            this.$router.push({\r\n              path: \"newgroupchatpage\",\r\n            });\r\n          })\r\n          .catch((res) => {\r\n            this.$toast.fail(\"建立群聊失败\");\r\n          });\r\n      } else {\r\n        this.$toast.fail(\"建立群聊必须两人以上\");\r\n      }\r\n\r\n      // 获取当前用户的创建和加入的群组\r\n      // WebIM.conn\r\n      //   .getJoinedGroups({\r\n      //     pageNum: 1,\r\n      //     pageSize: 20,\r\n      //     needAffiliations: false,\r\n      //     needRole: false,\r\n      //   })\r\n      //   .then((res) => {\r\n      //     // 解散所有群组(调试用)\r\n      //     res.data.map((item) => {\r\n      //       let option1 = {\r\n      //         groupId: item.groupid,\r\n      //       };\r\n      //       WebIM.conn.getGroupInfo(option1).then((re) => {\r\n      //         if (re.data[0].owner == this.userId) {\r\n      //           WebIM.conn.destroyGroup(option1).then((r) => {\r\n      //           });\r\n      //         }\r\n      //       });\r\n      //     });\r\n      //   });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n#build-group-chat-page {\r\n  width: 100vw;\r\n  height: 100vh;\r\n  color: rgb(164, 164, 164);\r\n  background-color: var(--theme-background-black);\r\n  h3 {\r\n    background-color: rgb(17, 17, 17);\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    width: 100%;\r\n    padding: 10px;\r\n    height: 45px;\r\n    span {\r\n      width: 58%;\r\n    }\r\n  }\r\n\r\n  .concent-top {\r\n    width: 100%;\r\n\r\n    .search {\r\n      width: 100%;\r\n      height: 50px;\r\n      display: flex;\r\n      flex-direction: row;\r\n      justify-content: space-around;\r\n      align-items: center;\r\n      position: relative;\r\n      color: white;\r\n      padding: 5px 0;\r\n      background-color: rgb(24, 24, 24);\r\n      border-bottom: 1px solid var(--theme-cell-black);\r\n\r\n      .input {\r\n        width: 75%;\r\n        height: 80%;\r\n        background-color: rgb(35, 35, 35);\r\n        outline: none;\r\n        border: none;\r\n        text-indent: 30px;\r\n      }\r\n\r\n      .search-icon {\r\n        color: rgb(164, 164, 164);\r\n        position: absolute;\r\n        left: 12px;\r\n        top: 18px;\r\n        font-size: 18px;\r\n      }\r\n    }\r\n    p {\r\n      display: inline-block;\r\n      height: 45px;\r\n      line-height: 30px;\r\n      width: 100%;\r\n      padding: 8px;\r\n      background-color: rgb(24, 24, 24);\r\n\r\n      &:not(:last-child) {\r\n        border-bottom: 1px solid rgba(204, 203, 203, 0.1);\r\n      }\r\n    }\r\n    .friend-list {\r\n      margin-top: 20px;\r\n\r\n      .friend-item {\r\n        height: 50px;\r\n        line-height: 50px;\r\n        width: 100%;\r\n        background-color: rgb(24, 24, 24);\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n        padding-left: 15px;\r\n\r\n        .van-checkbox {\r\n          padding-right: 10px;\r\n        }\r\n        .img {\r\n          width: 40px;\r\n          height: 40px;\r\n          border-radius: 5px;\r\n          margin-right: 15px;\r\n\r\n          img {\r\n            width: 100%;\r\n            height: 100%;\r\n            display: block;\r\n            border-radius: 3px;\r\n          }\r\n        }\r\n\r\n        .desc {\r\n          width: 70%;\r\n          height: 50px;\r\n          border-bottom: 1px solid rgba(204, 203, 203, 0.1);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .button {\r\n    position: absolute;\r\n    bottom: 0;\r\n    width: 100%;\r\n    height: 60px;\r\n    padding: 10px;\r\n    text-align: right;\r\n    background-color: rgb(67, 67, 67);\r\n    button {\r\n      outline: 0px;\r\n      border: 0px;\r\n      padding: 8px 15px;\r\n      color: #fff;\r\n      border-radius: 5px;\r\n      background-color: var(--theme-green);\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BuildGroupChatPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BuildGroupChatPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BuildGroupChatPage.vue?vue&type=template&id=385affd0&scoped=true&\"\nimport script from \"./BuildGroupChatPage.vue?vue&type=script&lang=js&\"\nexport * from \"./BuildGroupChatPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BuildGroupChatPage.vue?vue&type=style&index=0&id=385affd0&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"385affd0\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","on","routerGoBack","_v","staticClass","directives","name","rawName","value","inputValue","expression","domProps","$event","target","composing","model","selectBuildGroupFriends","callback","$$v","_l","friendsBasicList","item","key","phone","showImg","avatarurl","_s","nickname","showSureButton","isBuildGroup","length","staticRenderFns","data","created","computed","userId","watch","methods","getFriendsBasicList","WebIM","res","groupname","desc","members","public","approval","allowinvites","inviteNeedConfirm","maxusers","createGroup","then","id","isNewCreate","sessionStorage","path","catch","component"],"sourceRoot":""}