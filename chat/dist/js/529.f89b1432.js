"use strict";(self["webpackChunkchat_demo"]=self["webpackChunkchat_demo"]||[]).push([[529],{69529:function(t,e,s){s.r(e),s.d(e,{default:function(){return W}});s(57658);var n,o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"group-message"},[e("div",{staticClass:"title"},[e("van-icon",{attrs:{name:"arrow-left"},on:{click:function(e){return t.$router.back()}}}),e("h2",[t._v("聊天信息 ("+t._s(t.userMessage.length)+")")])],1),e("div",{staticClass:"user"},[t._l(t.userMessage,(function(s){return e("div",{key:s.nickname,staticClass:"user-item"},[e("div",{staticClass:"log"},[e("img",{attrs:{src:s.pic,alt:""}})]),e("p",[t._v(t._s(s.nickname))])])})),e("div",{staticClass:"add",on:{click:function(e){return t.$router.push("/adduseringroup")}}},[e("van-icon",{attrs:{name:"plus"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.ownerId==t.userId,expression:" ownerId == userId"}],staticClass:"del",on:{click:function(e){return t.$router.push("/deleteuserfromgroup")}}},[e("van-icon",{attrs:{name:"minus"}})],1)],2),e("div",{staticClass:"group-dec"},[e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("群聊名称")]),e("div",{staticClass:"log"},[t._v(" "+t._s(t.groupName)+" "),e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"},on:{click:t.changeGroupName}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("群二维码")]),e("div",{staticClass:"log"},[e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"anno-info"},[e("div",{staticClass:"title"},[e("div",{staticClass:"text"},[t._v("群公告")]),e("div",{staticClass:"log",on:{click:t.changeGroupAnnouncement}},[e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),e("p",[t._v(t._s(t.groupAnnouncement))])])]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("群管理")]),e("div",{staticClass:"log"},[e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("备注")]),e("div",{staticClass:"log"},[e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("查找聊天记录")]),e("div",{staticClass:"log"},[e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("消息免打扰")]),e("div",{staticClass:"log"},[e("van-switch",{attrs:{size:"20px","active-color":"rgb(100, 242, 112)","inactive-color":"rgb(107,107,107)"},model:{value:t.checked1,callback:function(e){t.checked1=e},expression:"checked1"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("置顶聊天")]),e("div",{staticClass:"log"},[e("van-switch",{attrs:{size:"20px","active-color":"rgb(100, 242, 112)","inactive-color":"rgb(107,107,107)"},model:{value:t.checked2,callback:function(e){t.checked2=e},expression:"checked2"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("保存到通信录")]),e("div",{staticClass:"log"},[e("van-switch",{attrs:{size:"20px","active-color":"rgb(100, 242, 112)","inactive-color":"rgb(107,107,107)"},model:{value:t.checked3,callback:function(e){t.checked3=e},expression:"checked3"}})],1)]),e("div",{staticClass:"group-item"},[e("div",{staticClass:"text"},[t._v("我在群里的昵称")]),e("div",{staticClass:"log"},[t._v(" "+t._s(t.userName)+" "+t._s(t.userMessage.pic)+" "),e("van-icon",{attrs:{name:"arrow",color:"rgb(107,107,107)"}})],1)]),t.isGroupOnwer?e("p",{staticClass:"is-dismiss-group"},[e("van-cell",{staticStyle:{background:"var(--theme-cell-black)","margin-top":"10px"},on:{click:t.isToSetDismissGroup}},[e("button",[t._v(" 解散该群聊 ")])])],1):t._e()]),e("van-popup",{staticClass:"dismiss-group-popup",style:{height:"15.2%",width:"70%"},attrs:{round:"","get-container":".group-message"},model:{value:t.isDismissGroup,callback:function(e){t.isDismissGroup=e},expression:"isDismissGroup"}},[e("p",[t._v("是否解散群聊")]),e("p",[e("button",{on:{click:t.cencelDisMissGroup}},[t._v("取消")]),e("button",{on:{click:t.disMissGroup}},[t._v("解散")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.ownerId!==t.userId,expression:" ownerId !== userId"}],staticClass:"bow-out",on:{click:function(e){return t.bowOut()}}},[t._v(" 退出群聊 ")]),e("van-popup",{staticClass:"is-change-group-anno",style:{height:"12.5%",width:"70%"},attrs:{round:"","get-container":".group-message"},model:{value:t.isRouterWriterGroupAnno,callback:function(e){t.isRouterWriterGroupAnno=e},expression:"isRouterWriterGroupAnno"}},[e("p",[t._v("只有群主及管理员可以编辑群公告")]),e("p",{on:{click:t.closeRouterWriterGroupAnno}},[t._v("知道了")])])],1)},i=[],r=(s(31958),s(76196),s(13332),s(56742),s(22666),s(62939),s(61452),s(39299)),a=s(36369),c=s(18701),l=s.n(c),u=s(26786),d=s(53370),h=s(80408),p=s(11047),g=s(57846),m=s(54398),v=s(2115),f=(0,u.d)("goods-action"),C=f[0],w=f[1],k=C({mixins:[(0,v.G)("vanGoodsAction")],props:{safeAreaInsetBottom:{type:Boolean,default:!0}},render:function(){var t=arguments[0];return t("div",{class:w({unfit:!this.safeAreaInsetBottom})},[this.slots()])}}),b=s(12250),I=(0,u.d)("goods-action-button"),G=I[0],y=I[1],B=G({mixins:[(0,v.j)("vanGoodsAction")],props:(0,r.Z)({},b.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),computed:{isFirst:function(){var t=this.parent&&this.parent.children[this.index-1];return!t||t.$options.name!==this.$options.name},isLast:function(){var t=this.parent&&this.parent.children[this.index+1];return!t||t.$options.name!==this.$options.name}},methods:{onClick:function(t){this.$emit("click",t),(0,b.BC)(this.$router,this)}},render:function(){var t=arguments[0];return t(m.Z,{class:y([{first:this.isFirst,last:this.isLast},this.type]),attrs:{size:"large",type:this.type,icon:this.icon,color:this.color,loading:this.loading,disabled:this.disabled},on:{click:this.onClick}},[this.slots()||this.text])}}),x=(0,u.d)("dialog"),_=x[0],A=x[1],$=x[2],O=_({mixins:[(0,g.e)()],props:{title:String,theme:String,width:[Number,String],message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,overlay:{type:Boolean,default:!0},allowHtml:{type:Boolean,default:!0},transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},closeOnPopstate:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var e=this;this.$emit(t),this.value&&(this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(s){!1!==s&&e.loading[t]&&e.onClose(t),e.loading.confirm=!1,e.loading.cancel=!1}))):this.onClose(t))},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){var t=this;this.$emit("opened"),this.$nextTick((function(){var e;null==(e=t.$refs.dialog)||e.focus()}))},onClosed:function(){this.$emit("closed")},onKeydown:function(t){var e=this;if("Escape"===t.key||"Enter"===t.key){if(t.target!==this.$refs.dialog)return;var s={Enter:this.showConfirmButton?function(){return e.handleAction("confirm")}:d.ZT,Escape:this.showCancelButton?function(){return e.handleAction("cancel")}:d.ZT};s[t.key](),this.$emit("keydown",t)}},genRoundButtons:function(){var t=this,e=this.$createElement;return e(k,{class:A("footer")},[this.showCancelButton&&e(B,{attrs:{size:"large",type:"warning",text:this.cancelButtonText||$("cancel"),color:this.cancelButtonColor,loading:this.loading.cancel},class:A("cancel"),on:{click:function(){t.handleAction("cancel")}}}),this.showConfirmButton&&e(B,{attrs:{size:"large",type:"danger",text:this.confirmButtonText||$("confirm"),color:this.confirmButtonColor,loading:this.loading.confirm},class:A("confirm"),on:{click:function(){t.handleAction("confirm")}}})])},genButtons:function(){var t,e=this,s=this.$createElement,n=this.showCancelButton&&this.showConfirmButton;return s("div",{class:[p.k7,A("footer")]},[this.showCancelButton&&s(m.Z,{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||$("cancel"),nativeType:"button"},class:A("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){e.handleAction("cancel")}}}),this.showConfirmButton&&s(m.Z,{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||$("confirm"),nativeType:"button"},class:[A("confirm"),(t={},t[p.a8]=n,t)],style:{color:this.confirmButtonColor},on:{click:function(){e.handleAction("confirm")}}})])},genContent:function(t,e){var s=this.$createElement;if(e)return s("div",{class:A("content")},[e]);var n=this.message,o=this.messageAlign;if(n){var i,r,a={class:A("message",(i={"has-title":t},i[o]=o,i)),domProps:(r={},r[this.allowHtml?"innerHTML":"textContent"]=n,r)};return s("div",{class:A("content",{isolated:!t})},[s("div",l()([{},a]))])}}},render:function(){var t=arguments[0];if(this.shouldRender){var e=this.message,s=this.slots(),n=this.slots("title")||this.title,o=n&&t("div",{class:A("header",{isolated:!e&&!s})},[n]);return t("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||e,tabIndex:0},class:[A([this.theme]),this.className],style:{width:(0,h.N)(this.width)},ref:"dialog",on:{keydown:this.onKeydown}},[o,this.genContent(n,s),"round-button"===this.theme?this.genRoundButtons():this.genButtons()])])}}});function S(t){return document.body.contains(t)}function Z(){n&&n.$destroy(),n=new(a.ZP.extend(O))({el:document.createElement("div"),propsData:{lazyRender:!1}}),n.$on("input",(function(t){n.value=t}))}function N(t){return d.sk?Promise.resolve():new Promise((function(e,s){n&&S(n.$el)||Z(),(0,r.Z)(n,N.currentOptions,t,{resolve:e,reject:s})}))}N.defaultOptions={value:!0,title:"",width:"",theme:null,message:"",overlay:!0,className:"",allowHtml:!0,lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,callback:function(t){n["confirm"===t?"resolve":"reject"](t)}},N.alert=N,N.confirm=function(t){return N((0,r.Z)({showCancelButton:!0},t))},N.close=function(){n&&(n.value=!1)},N.setDefaultOptions=function(t){(0,r.Z)(N.currentOptions,t)},N.resetDefaultOptions=function(){N.currentOptions=(0,r.Z)({},N.defaultOptions)},N.resetDefaultOptions(),N.install=function(){a.ZP.use(O)},N.Component=O,a.ZP.prototype.$dialog=N;var T=N,D=s(29146),M=s(63822),R={data(){return{userMessage:[],checked1:!1,checked2:!0,checked3:!0,groupId:"",groupName:"",groupAnnouncement:"",groupOwner:"",isRouterWriterGroupAnno:!1,userName:"",isGroupOnwer:!1,isDismissGroup:!1,ownerId:""}},computed:{...(0,M.rn)({newCreateGroupId:t=>t.home.newCreateGroupId,cacheClickGroupId:t=>t.home.cacheClickGroupId,userId:t=>t.user.userId})},created(){this.getGroupId()},watch:{userId(){this.getGroupId()}},methods:{getGroupId(){""!==this.userId&&(D.Z.conn.fetchUserInfoById(this.userId,"nickname").then((t=>{this.userName=t.data[this.userId].nickname})),""!==this.newCreateGroupId?this.groupId=this.newCreateGroupId:""==this.newCreateGroupId&&""!==this.cacheClickGroupId?this.groupId=this.cacheClickGroupId:""==this.newCreateGroupId&&""==this.cacheClickGroupId&&(this.groupId=sessionStorage.getItem("groupInfoCacheSave")),this.getGroupMenbers(),this.getGroupInfo(),this.getGroupAnnouncement())},getGroupMenbers(){let t={pageNum:1,pageSize:200,groupId:this.groupId};D.Z.conn.listGroupMembers(t).then((t=>{let e=t.data;e.map(((t,e)=>{t.owner&&(this.ownerId=t.owner),D.Z.conn.fetchUserInfoById(t.owner??t.member).then((e=>{let n=e.data[t.owner??t.member].nickname,o=e.data[t.owner??t.member].avatarurl??s(10064),i={nickname:n,pic:o};this.userMessage.push(i)}))}))}))},getGroupInfo(){let t={groupId:this.groupId};D.Z.conn.getGroupInfo(t).then((t=>{this.groupName=t.data[0].name,this.groupOwner=t.data[0].owner,this.userId==this.groupOwner?this.isGroupOnwer=!0:this.isGroupOnwer=!1}))},changeGroupName(){this.$router.push({path:"/changegroupname"})},getGroupAnnouncement(){let t={groupId:this.groupId};D.Z.conn.fetchGroupAnnouncement(t).then((t=>{this.groupAnnouncement=t.data.announcement}))},changeGroupAnnouncement(){this.groupOwner==this.userId?this.$router.push({path:"/changegroupannouncement"}):this.isRouterWriterGroupAnno=!0},closeRouterWriterGroupAnno(){this.isRouterWriterGroupAnno=!1},isToSetDismissGroup(){this.isDismissGroup=!0},cencelDisMissGroup(){this.isDismissGroup=!1},disMissGroup(){let t={groupId:this.groupId};D.Z.conn.destroyGroup(t).then((t=>{this.$toast.success("解散该群聊"),this.isDismissGroup=!1,this.$router.push({path:"/"})}))},bowOut(){T.confirm({title:"确认退出群聊吗",message:""}).then((()=>{console.log(123);let t={groupId:this.groupId};D.Z.conn.leaveGroup(t).then((t=>{console.log(t),this.$toast("退出成功"),this.$router.push("/")}))})).catch((()=>{}))}}},z=R,E=s(43736),P=(0,E.Z)(z,o,i,!1,null,"05cc41b7",null),W=P.exports}}]);
//# sourceMappingURL=529.f89b1432.js.map